var Emitter  = require('events').EventEmitter;
var nopt     = require('nopt');

var template = require('../util/template');
var help     = require('./help');

var optionTypes = { help: Boolean, server: ["production", "stageing"], destination: String };
var shorthand   = { 'h': ['--help'], 's': ['--server'], 'D': ['--destination'] };

module.exports = function (server, options) {
  options = options || {};

  var emitter = new Emitter;

  if (options.server){
    console.log(options.server);
  } else {
     return emitter.emit('error', new Error('nu e bine')).on('error', emitter.emit.bind(emitter, 'error'));
  };

  return emitter;
};

module.exports.line = function (argv) {
  var options  = nopt(optionTypes, shorthand, argv);
  var server    = options.argv.remain.slice(1);

  if (options.help) return help('get-logs');
  return module.exports(server, options);
};

module.exports.completion = function (opts, cb) {
    return cb(null, Object.keys(require('../commands')));
};
